贷款计算器

lilv_array = new Array; 
//08年12月23日利率下限(7折)
lilv_array[1] = new Array;
lilv_array[1][1] = new Array;
lilv_array[1][2] = new Array;
lilv_array[1][1][5] = 0.0403;//商贷 1～5年 4.03%
lilv_array[1][1][10] = 0.0416;//商贷 5-30年 4.16%
lilv_array[1][2][5] = 0.0333;//公积金 1～5年 3.33%
lilv_array[1][2][10] = 0.0387;//公积金 5-30年 3.87%
//08年12月23日利率下限(85折)
lilv_array[2] = new Array;
lilv_array[2][1] = new Array;
lilv_array[2][2] = new Array;
lilv_array[2][1][5] = 0.049;//商贷 1～5年 4.9%
lilv_array[2][1][10] = 0.0505;//商贷 5-30年 5.05%
lilv_array[2][2][5] = 0.0333;//公积金 1～5年 3.33%
lilv_array[2][2][10] = 0.0387;//公积金 5-30年 3.87%
//08年12月23日基准利率
lilv_array[3] = new Array;
lilv_array[3][1] = new Array;
lilv_array[3][2] = new Array;
lilv_array[3][1][5] = 0.0576;//商贷 1～5年 5.76%
lilv_array[3][1][10] = 0.0594;//商贷 5-30年 5.94%
lilv_array[3][2][5] = 0.0333;//公积金 1～5年 3.33%
lilv_array[3][2][10] = 0.0387;//公积金 5-30年 3.87%
//08年12月23日利率上限(1.1倍)
lilv_array[4] = new Array;
lilv_array[4][1] = new Array;
lilv_array[4][2] = new Array;
lilv_array[4][1][5] = 0.0634;//商贷 1～5年 6.34%
lilv_array[4][1][10] = 0.0653;//商贷 5-30年 6.53%
lilv_array[4][2][5] = 0.0333;//公积金 1～5年 3.33%
lilv_array[4][2][10] = 0.0387;//公积金 5-30年 3.87%
//10年10月20日利率下限(7折)
lilv_array[5] = new Array;
lilv_array[5][1] = new Array;
lilv_array[5][2] = new Array;
lilv_array[5][1][5] = 0.04172;//商贷 1～5年 4.172%
lilv_array[5][1][10] = 0.04298;//商贷 5-30年 4.298%
lilv_array[5][2][5] = 0.035;//公积金 1～5年 3.5%
lilv_array[5][2][10] = 0.0405;//公积金 5-30年 4.05%
//10年10月20日利率下限(85折)
lilv_array[6] = new Array;
lilv_array[6][1] = new Array;
lilv_array[6][2] = new Array;
lilv_array[6][1][5] = 0.05066;//商贷 1～5年 5.066%
lilv_array[6][1][10] = 0.05218;//商贷 5-30年 5.218%
lilv_array[6][2][5] = 0.035;//公积金 1～5年 3.5%
lilv_array[6][2][10] = 0.0405;//公积金 5-30年 4.05%
//10年10月20日基准利率
lilv_array[7] = new Array;
lilv_array[7][1] = new Array;
lilv_array[7][2] = new Array;
lilv_array[7][1][5] = 0.0596;//商贷 1～5年 5.96%
lilv_array[7][1][10] = 0.0614;//商贷 5-30年 6.14%
lilv_array[7][2][5] = 0.035;//公积金 1～5年 3.5%
lilv_array[7][2][10] = 0.0405;//公积金 5-30年 4.05%
//10年10月20日利率上限(1.1倍)
lilv_array[8] = new Array;
lilv_array[8][1] = new Array;
lilv_array[8][2] = new Array;
lilv_array[8][1][5] = 0.06556;//商贷 1～5年 6.556%
lilv_array[8][1][10] = 0.06754;//商贷 5-30年 6.754%
lilv_array[8][2][5] = 0.035;//公积金 1～5年 3.5%
lilv_array[8][2][10] = 0.0405;//公积金 5-30年 4.05%
//10年12月26日基准利率
lilv_array[9] = new Array;
lilv_array[9][1] = new Array;
lilv_array[9][2] = new Array;
lilv_array[9][1][5] = 0.0622;//商贷 1～5年 6.22%
lilv_array[9][1][10] = 0.0640;//商贷 5-30年 6.4%
lilv_array[9][2][5] = 0.0375;//公积金 1～5年 3.75%
lilv_array[9][2][10] = 0.0430;//公积金 5-30年 4.3%
//10年12月26日利率下限(7折)
lilv_array[10] = new Array;
lilv_array[10][1] = new Array;
lilv_array[10][2] = new Array;
lilv_array[10][1][5] = 0.04354;//商贷 1～5年 4.354%
lilv_array[10][1][10] = 0.0448;//商贷 5-30年 4.48%
lilv_array[10][2][5] = 0.0375;//公积金 1～5年 3.75%
lilv_array[10][2][10] = 0.0430;//公积金 5-30年 4.3%
//10年12月26日利率上限(1.1倍)
lilv_array[11] = new Array;
lilv_array[11][1] = new Array;
lilv_array[11][2] = new Array;
lilv_array[11][1][5] = 0.06842;//商贷 1～5年 6.842%
lilv_array[11][1][10] = 0.0704;//商贷 5-30年 7.04%
lilv_array[11][2][5] = 0.0375;//公积金 1～5年 3.75%
lilv_array[11][2][10] = 0.0430;//公积金 5-30年 4.3%
//11年2月9日基准利率
lilv_array[12] = new Array;
lilv_array[12][1] = new Array;
lilv_array[12][2] = new Array;
lilv_array[12][1][5] = 0.0645;//商贷 1～5年 6.45%
lilv_array[12][1][10] = 0.0660;//商贷 5-30年 6.6%
lilv_array[12][2][5] = 0.0400;//公积金 1～5年 4%
lilv_array[12][2][10] = 0.0450;//公积金 5-30年 4.5%
//11年2月9日利率下限(7折)
lilv_array[13] = new Array;
lilv_array[13][1] = new Array;
lilv_array[13][2] = new Array;
lilv_array[13][1][5] = 0.04515;//商贷 1～5年 4.515%
lilv_array[13][1][10] = 0.04620;//商贷 5-30年 4.62%
lilv_array[13][2][5] = 0.0400;//公积金 1～5年 4%
lilv_array[13][2][10] = 0.0450;//公积金 5-30年 4.5%
//11年2月9日利率下限(85折)
lilv_array[14] = new Array;
lilv_array[14][1] = new Array;
lilv_array[14][2] = new Array;
lilv_array[14][1][5] = 0.054825;//商贷 1～5年 5.4825%
lilv_array[14][1][10] = 0.0561;//商贷 5-30年 5.61%
lilv_array[14][2][5] = 0.0400;//公积金 1～5年 4%
lilv_array[14][2][10] = 0.0450;//公积金 5-30年 4.5%
//11年2月9日利率上限(1.1倍)
lilv_array[15] = new Array;
lilv_array[15][1] = new Array;
lilv_array[15][2] = new Array;
lilv_array[15][1][5] = 0.07095;//商贷 1～5年 7.095%
lilv_array[15][1][10] = 0.0726;//商贷 5-30年 7.26%
lilv_array[15][2][5] = 0.0400;//公积金 1～5年 4%
lilv_array[15][2][10] = 0.0450;//公积金 5-30年 4.5%
//11年4月5日基准利率
lilv_array[16] = new Array;
lilv_array[16][1] = new Array;
lilv_array[16][2] = new Array;
lilv_array[16][1][5] = 0.0665;//商贷 1～5年 6.65%
lilv_array[16][1][10] = 0.0680;//商贷 5-30年 6.8%
lilv_array[16][2][5] = 0.0420;//公积金 1～5年 4.2%
lilv_array[16][2][10] = 0.0470;//公积金 5-30年 4.7%
//11年4月5日利率下限（7折）
lilv_array[17] = new Array;
lilv_array[17][1] = new Array;
lilv_array[17][2] = new Array;
lilv_array[17][1][5] = 0.04655;//商贷 1～5年 4.655%
lilv_array[17][1][10] = 0.0476;//商贷 5-30年 4.76%
lilv_array[17][2][5] = 0.0420;//公积金 1～5年 4.2%
lilv_array[17][2][10] = 0.0470;//公积金 5-30年 4.7%
//11年4月5日利率下限（85折）
lilv_array[18] = new Array;
lilv_array[18][1] = new Array;
lilv_array[18][2] = new Array;
lilv_array[18][1][5] = 0.056525;//商贷 1～5年 5.6525%
lilv_array[18][1][10] = 0.0578;//商贷 5-30年 5.78%
lilv_array[18][2][5] = 0.0420;//公积金 1～5年 4.2%
lilv_array[18][2][10] = 0.0470;//公积金 5-30年 4.7%
//11年4月5日利率上限（1.1倍）
lilv_array[19] = new Array;
lilv_array[19][1] = new Array;
lilv_array[19][2] = new Array;
lilv_array[19][1][5] = 0.07315;//商贷 1～5年 7.315%
lilv_array[19][1][10] = 0.0748;//商贷 5-30年 7.48%
lilv_array[19][2][5] = 0.0420;//公积金 1～5年 4.2%
lilv_array[19][2][10] = 0.0470;//公积金 5-30年 4.7%
//11年7月6日基准利率
lilv_array[20] = new Array;
lilv_array[20][1] = new Array;
lilv_array[20][2] = new Array;
lilv_array[20][1][5] = 0.0690;//商贷 1～5年 6.9%
lilv_array[20][1][10] = 0.0705;//商贷 5-30年 7.05%
lilv_array[20][2][5] = 0.0445;//公积金 1～5年 4.45%
lilv_array[20][2][10] = 0.0490;//公积金 5-30年 4.9%
//11年7月6日利率下限（7折）
lilv_array[21] = new Array;
lilv_array[21][1] = new Array;
lilv_array[21][2] = new Array;
lilv_array[21][1][5] = 0.0483;//商贷 1～5年 4.83%
lilv_array[21][1][10] = 0.04935;//商贷 5-30年 4.935%
lilv_array[21][2][5] = 0.0445;//公积金 1～5年 4.45%
lilv_array[21][2][10] = 0.0490;//公积金 5-30年 4.9%
//11年7月6日利率下限（85折）
lilv_array[22] = new Array;
lilv_array[22][1] = new Array;
lilv_array[22][2] = new Array;
lilv_array[22][1][5] = 0.05865;//商贷 1～5年 5.865%
lilv_array[22][1][10] = 0.059925;//商贷 5-30年 5.9925%
lilv_array[22][2][5] = 0.0445;//公积金 1～5年 4.45%
lilv_array[22][2][10] = 0.0490;//公积金 5-30年 4.9%
//11年7月6日利率上限（1.1倍）
lilv_array[23] = new Array;
lilv_array[23][1] = new Array;
lilv_array[23][2] = new Array;
lilv_array[23][1][5] = 0.0759;//商贷 1～5年 7.59%
lilv_array[23][1][10] = 0.07755;//商贷 5-30年 7.755%
lilv_array[23][2][5] = 0.0445;//公积金 1～5年 4.45%
lilv_array[23][2][10] = 0.0490;//公积金 5-30年 4.9%
//12年6月8日基准利率
lilv_array[24] = new Array;
lilv_array[24][1] = new Array;
lilv_array[24][2] = new Array;
lilv_array[24][1][5] = 0.0665;//商贷 1～5年 6.65%
lilv_array[24][1][10] = 0.0680;//商贷 5-30年 6.8%
lilv_array[24][2][5] = 0.0420;//公积金 1～5年 4.2%
lilv_array[24][2][10] = 0.0470;//公积金 5-30年 4.7%
//12年6月8日利率下限（7折）
lilv_array[25] = new Array;
lilv_array[25][1] = new Array;
lilv_array[25][2] = new Array;
lilv_array[25][1][5] = 0.04655;//商贷 1～5年 4.655%
lilv_array[25][1][10] = 0.0476;//商贷 5-30年 4.76%
lilv_array[25][2][5] = 0.0420;//公积金 1～5年 4.2%
lilv_array[25][2][10] = 0.0470;//公积金 5-30年 4.7%
//12年6月8日利率下限（85折）
lilv_array[26] = new Array;
lilv_array[26][1] = new Array;
lilv_array[26][2] = new Array;
lilv_array[26][1][5] = 0.056525;//商贷 1～5年 5.6525%
lilv_array[26][1][10] = 0.0578;//商贷 5-30年 5.78%
lilv_array[26][2][5] = 0.0420;//公积金 1～5年 4.2%
lilv_array[26][2][10] = 0.0470;//公积金 5-30年 4.7%
//12年6月8日利率上限（1.1倍）
lilv_array[27] = new Array;
lilv_array[27][1] = new Array;
lilv_array[27][2] = new Array;
lilv_array[27][1][5] = 0.07315;//商贷 1～5年 7.315%
lilv_array[27][1][10] = 0.0748;//商贷 5-30年 7.48%
lilv_array[27][2][5] = 0.0420;//公积金 1～5年 4.2%
lilv_array[27][2][10] = 0.0470;//公积金 5-30年 4.7%
//12年7月6日基准利率
lilv_array[28] = new Array;
lilv_array[28][1] = new Array;
lilv_array[28][2] = new Array;
lilv_array[28][1][5] = 0.0640;//商贷 1～5年 6.4%
lilv_array[28][1][10] = 0.0655;//商贷 5-30年 6.55%
lilv_array[28][2][5] = 0.0400;//公积金 1～5年 4%
lilv_array[28][2][10] = 0.0450;//公积金 5-30年 4.5%
//12年7月6日利率下限（7折）
lilv_array[29] = new Array;
lilv_array[29][1] = new Array;
lilv_array[29][2] = new Array;
lilv_array[29][1][5] = 0.0448;//商贷 1～5年 4.48%
lilv_array[29][1][10] = 0.04585;//商贷 5-30年 4.585%
lilv_array[29][2][5] = 0.0400;//公积金 1～5年 4%
lilv_array[29][2][10] = 0.0450;//公积金 5-30年 4.5%
//12年7月6日利率下限（85折）
lilv_array[30] = new Array;
lilv_array[30][1] = new Array;
lilv_array[30][2] = new Array;
lilv_array[30][1][5] = 0.0544;//商贷 1～5年 5.44%
lilv_array[30][1][10] = 0.055675;//商贷 5-30年 5.5675%
lilv_array[30][2][5] = 0.0400;//公积金 1～5年 4%
lilv_array[30][2][10] = 0.0450;//公积金 5-30年 4.5%
//12年7月6日利率上限（1.1倍）
lilv_array[31] = new Array;
lilv_array[31][1] = new Array;
lilv_array[31][2] = new Array;
lilv_array[31][1][5] = 0.0704;//商贷 1～5年 7.04%
lilv_array[31][1][10] = 0.07205;//商贷 5-30年 7.205%
lilv_array[31][2][5] = 0.0400;//公积金 1～5年 4%
lilv_array[31][2][10] = 0.0450;//公积金 5-30年 4.5%


//得到利率
function getlilv(lilv_class,type,years){
	var lilv_class = parseInt(lilv_class);
    if (years<=5){
		 return lilv_array[lilv_class][type][5];
	}else{
		return lilv_array[lilv_class][type][10];
	}
}

//本金还款的月还款额(参数: 年利率 / 贷款总额 / 贷款总月份 / 贷款当前月0～length-1)
function getMonthMoney2(lilv,total,month,cur_month){
	var lilv_month = lilv / 12;//月利率
	//return total * lilv_month * Math.pow(1 + lilv_month, month) / ( Math.pow(1 + lilv_month, month) -1 );
	var benjin_money = total/month;
	return (total - benjin_money * cur_month) * lilv_month + benjin_money;

}

//本息还款的月还款额(参数: 年利率/贷款总额/贷款总月份)
function getMonthMoney1(lilv,total,month){
	var lilv_month = lilv / 12;//月利率
	return total * lilv_month * Math.pow(1 + lilv_month, month) / ( Math.pow(1 + lilv_month, month) -1 );
}

function ext_total(fmobj){
	var years = 按揭年数;
	var month = 按揭年数 * 12;

	贷款月数 = month+"(月)";
	if (fmobj.type.value == 3 ){
		//--  组合型贷款(组合型贷款的计算，只和商业贷款额、和公积金贷款额有关，和按贷款总额计算无关)
			var total_sy = 商业性*10000;
			var total_gjj = 公积金*10000;
			房屋总价 = "略";//房款总额
			首期付款 = 0;//首期付款

			//贷款总额
			var total_sy = parseInt(商业性*10000);
			var total_gjj = parseInt(公积金*10000);
			var daikuan_total = total_sy + total_gjj;
			贷款总额 = Math.round(daikuan_total);

			//月还款
			var lilv_sd = getlilv(银行利率,1, years);//得到商贷利率
			var lilv_gjj = getlilv(银行利率,2, years);//得到公积金利率

			//1.本金还款
				//月还款
				var all_total2 = 0;
				var month_money2 = "";
				for(j=0;j<month;j++) {
					//调用函数计算: 本金月还款额
					huankuan = getMonthMoney2(lilv_sd,total_sy,month,j) + getMonthMoney2(lilv_gjj,total_gjj,month,j);
					all_total2 += huankuan;
					huankuan = Math.round(huankuan*100)/100;
					month_money2 += (j+1) +"月," + huankuan + "(元)\n";
				}
				每月还款 = month_money2;
				//还款总额
				还款总额 = Math.round(all_total2*100)/100;
				//支付利息款
				支付利息.innerHTML = Math.round( (all_total2 - daikuan_total) *100)/100;


			//2.本息还款
				//月均还款
				var month_money1 = getMonthMoney1(lilv_sd,total_sy,month) + getMonthMoney1(lilv_gjj,total_gjj,month);//调用函数计算
				月均还款 = Math.round(month_money1*100)/100 + "(元)";
				//还款总额
				var all_total1 = month_money1 * month;
				还款总额 = Math.round(all_total1*100)/100;
				//支付利息款
				支付利息税 = Math.round( (all_total1 - daikuan_total) *100)/100;

	}else{
		//--  商业贷款、公积金贷款
			var lilv = getlilv(银行利率,货款类别(selected_index), 按揭年数);//得到利率
			if (根据面积、单价计算 == true){
				//------------ 根据单价面积计算

				//房款总额
				var fangkuan_total = 单价 * 面积;
				房屋总价 = fangkuan_total;
				//贷款总额
				var daikuan_total = (单价 * 面积) * (按揭成数(selected_index)/10);
				贷款总额 = Math.round(daikuan_total);
				//首期付款
				var money_first = fangkuan_total - daikuan_total;
				首期付款 = Math.round(money_first);
			}else{
				//------------ 根据贷款总额计算

				//房款总额
				房屋总价 = "略";
				房款总价 = "略";
				//贷款总额
				var daikuan_total = 贷款总额(输入框)*10000;
				贷款总额(显示结果) = Math.round(daikuan_total);
				//首期付款
				首期付款 = 0;
			}
			//1.本金还款
				//月还款
				var all_total2 = 0;
				var month_money2 = "";
				for(j=0;j<month;j++) {
					//调用函数计算: 本金月还款额
					huankuan = getMonthMoney2(lilv,daikuan_total,month,j);
					all_total2 += huankuan;
					huankuan = Math.round(huankuan*100)/100;
					month_money2 += (j+1) +"月," + huankuan + "(元)\n";
				}
				每月还款 = month_money2;
				//还款总额
				还款总额 = Math.round(all_total2*100)/100;
				//支付利息款
				支付利息 = Math.round( (all_total2 - daikuan_total) *100)/100;


			//2.本息还款
				//月均还款
				var month_money1 = getMonthMoney1(lilv,daikuan_total,month);//调用函数计算
				月均还款 = Math.round(month_money1*100)/100 + "(元)";
				//还款总额
				var all_total1 = month_money1 * month;
				还款总额 = Math.round(all_total1*100)/100;
				//支付利息款
				支付利息税 = Math.round( (all_total1 - daikuan_total) *100)/100;

	}
}